//===----------------------------------------------------------------------===//
// Copyright Â© 2024-2025 Apple Inc. and the Pkl project authors. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//===----------------------------------------------------------------------===//
/// The Extension object represents the possibility of adding additional data
/// to extend the specification at certain points.
///
/// <https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.3.md#specification-extensions>
module org.openapis.v3.Extension

import "Info.pkl"
import "SecurityScheme.pkl"
import "Schema.pkl"

/// A string representing the key of an extension.
typealias Key = String(startsWith("x-"), length > 2)

hidden converters: Mapping<Class|String, (unknown) -> Any> = new {
  local extractExtensions = (it: Module) -> it.toMap() + (it.getProperty("extensions") ?? Map()).toMap()
  [Schema.getClass()] = extractExtensions
  [SecurityScheme.getClass()] = extractExtensions
  [Info.getClass()] = extractExtensions
}
